---
- hosts: vps
  tasks:
    - name: Add repos and update package manager cache before main playbook execution
      import_tasks: package_cache_update.yml
      #this is useful to save time on playbook execution

- hosts: vps
  roles:
    - nginx
    - php-fpm
    - mysql
    - phpmyadmin
    - sftp
    - fail2ban
    - certbot

- hosts: vps
  tasks:
    - name: Chek on dhparam file generation
      async_status:
        jid: '{{ dhparam_sleeper.ansible_job_id }}'
      register: job_result
      until: job_result.finished
      retries: 30
