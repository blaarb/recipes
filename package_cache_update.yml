---
- name: Install debian packages required to add php repo
  apt:
    name: "{{ package_list }}"
  vars:
    package_list:
      - lsb-release
      - apt-transport-https
      - ca-certificates
  when: ansible_facts['distribution']  == "Debian"

- name: Add nginx mainline debian php repo # to get the latest nginx (not the most stable) version
  apt_repository:
    repo: deb http://nginx.org/packages/mainline/debian {{ ansible_facts['distribution_release'] }} nginx
  when: ansible_facts['distribution']  == "Debian"

- name: Add packages.sury.org/php debian php repo
  apt_repository:
    update_cache: yes
    repo: deb https://packages.sury.org/php {{ ansible_facts['distribution_release'] }} main
  when: ansible_facts['distribution']  == "Debian"

- name: Add ppa:ondrej/php php ubuntu repo
  apt_repository:
    update_cache: yes
    repo: ppa:ondrej/php
  when: ansible_facts['distribution']  == "Ubuntu"

- name: Update yum cache
  yum:
    name: curl
    state: latest
    update_cache: yes
  when: ansible_facts['os_family'] == "RedHat"
